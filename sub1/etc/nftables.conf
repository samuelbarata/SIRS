#!/usr/sbin/nft -f

# Networks
define corporate_network = 95.92.192.0/21
define service_network = 95.92.204.0/25
define data_historian_network = 95.92.204.128/25
define scada_network = 95.92.200.0/22
define substation_networks = { 95.92.201.0/24, 95.92.202.0/24 }
define network = { 95.92.192.0/20 }
# Hosts
define dns = 95.92.204.53
define web = 95.92.204.80
define db = 95.92.204.130
#TODO: change db port
define db_ports = {1024-65535}
define vpn = 95.92.200.2
# Groups
define service_hosts = { 95.92.204.53, 95.92.204.80 }
define dhcp_gateways = { 0.0.0.0, 95.92.192.1 }


# Interfaces
define internet_interfaces = { eth0 }
define vpn_interfaces = { tun0 }


flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;
		#iif $dhcp_interfaces udp sport 68 ip daddr $dhcp_gateways counter accept comment "Accept DHCP traffic"
	}
	chain forward {
		type filter hook forward priority 0; policy drop;
		tcp dport 1194 ip daddr $scada_network counter accept comment "Accept SCADA"
	}
	chain output {
		type filter hook forward priority 0; policy drop;
		tcp dport 1194 ip daddr $scada_network counter accept comment "Accept SCADA"
	}
}
